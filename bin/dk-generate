#!/usr/bin/env python2

import sys, optparse

from deploymentkit import core

if __name__ == '__main__':

    parser = optparse.OptionParser(usage="Usage: %prog [options] FILE.yaml")
    parser.add_option("-t", "--target", dest="target", default="",
                      help="Target platform to generate for", metavar="TARGET")
    parser.add_option("-o", "--output-directory", dest="output_dir", default="./",
                      help="Directory to output generated files to", metavar="DIR")
    parser.add_option("", "--help-input", action="store_true",
                      help="Show help about input file format")

    (options, args) = parser.parse_args()

    if options.help_input:
        parser.print_usage()
        print core.PackageMetadata.__doc__

    else:
        if len(args) < 1:
            parser.error("No input file specified")
        elif len(args) > 1:
            parser.error("Too many arguments")

        input_file = args[0]

        core.generate_recipe(input_file, options.output_dir, options.target)
